# --- ベースイメージの指定 ---
# Python 3.10 の軽量なイメージをベースにします
FROM python:3.10-slim

# --- 作業ディレクトリの設定 ---
# コンテナ内の /app ディレクトリで作業します
WORKDIR /app

# --- 依存関係のインストール ---
# まず requirements.txt だけをコピーして、ライブラリをインストールします。
# こうすることで、アプリケーションのコードを変更しただけでは再インストールが走らず、ビルドが高速になります。
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# --- アプリケーションコードのコピー ---
# プロジェクトのファイルを作業ディレクトリにコピーします
COPY . .

# --- ポートの公開 ---
# Flaskアプリケーションがリッスンするポートを公開します
EXPOSE 5000

# --- アプリケーションの実行コマンド ---
# コンテナが起動したときに、Gunicornを使ってアプリケーションを実行します
CMD ["gunicorn", "--bind", "0.0.0.0:5000", "wsgi:app"]